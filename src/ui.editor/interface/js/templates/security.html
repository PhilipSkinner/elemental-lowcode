<template id="template-security">
	<div class="security">
		<permissions :roles="['security_reader','security_admin','system_reader','system_admin']"></permissions>

		<navigation title="Security" :navitems="navitems"></navigation>

		<alert text="Security settings saved!" v-bind:visible="showAlert"></alert>

		<confirm
			title="Confirmation"
			message="Are you sure you want to delete this client?"
			v-bind:visible="deleteClientConfirmVisible"
			v-bind:on-confirm="confirmClientDeleteAction"
		></confirm>

		<confirm
			title="Confirmation"
			message="Are you sure you want to delete this user?"
			v-bind:visible="deleteUserConfirmVisible"
			v-bind:on-confirm="confirmUserDeleteAction"
		></confirm>

		<confirm
			title="Confirmation"
			message="Are you sure you want to delete this secret?"
			v-bind:visible="deleteSecretConfirmVisible"
			v-bind:on-confirm="confirmSecretDeleteAction"
		></confirm>

        <div class="container-fluid" v-if="bannedPasswordsVisible">
            <div class="row">
                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Banned Passwords</h6>
                        </div>
                        <div class="card-body" v-if="addingBannedPassword">
                            <p>
                                Enter your new banned password below.
                            </p>

                            <div class="form-group">
                                <label>Banned Password:</label>
                                <input type="text" class="form-control" name="name" v-model="currentPassword" />
                            </div>

                            <div class="float-left">
                                <button class="btn btn-default" v-on:click="window._securityControllerInstance.cancelSetBannedPassword()">
                                    Cancel
                                </button>
                            </div>

                            <div class="float-right">
                                <button class="btn btn-success" v-on:click="window._securityControllerInstance.saveBannedPassword()">
                                    Save
                                </button>
                            </div>
                        </div>
                        <div class="card-body" v-if="!addingBannedPassword">
                            <div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityControllerInstance.addBannedPassword()">
                                    Add Banned Password
                                </button>
                            </div>

                            <p>
                                These passwords will be banned from being used by users across all of your applications.
                            </p>

                            <div class="table-responsive">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="bannedPasswords.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No banned passwords have been defined.
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-for="password in bannedPasswords">
                                            <td>
                                                {{password}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityControllerInstance.removeBannedPassword(password)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

		<div class="container-fluid" v-if="secretsVisible">
			<div class="row">
				<div class="col-md-12">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Secrets</h6>
						</div>
						<div class="card-body" v-if="addingSecret">
							<p>
								Provide a name name for your secret, plus a scope. The scope controls which applications this secret will be available to.
							</p>

							<div class="form-group">
								<label>Name:</label>
								<input type="text" class="form-control" name="name" v-model="currentSecret.name" />
							</div>

							<div class="form-group">
								<label>Scope:</label>
								<select class="form-control" name="name" v-model="currentSecret.scope">
									<option value="global">Global</option>
									<option value="system:identity">System - Identity</option>
									<option value="system:integration">System - Integrations</option>
									<option value="system:api">System - APIs</option>
									<option value="system:queues">System - Messaging</option>
									<option value="system:data">System - Data</option>
									<option value="system:website">System - Websites</option>
									<option value="system:rules">System - Rulesets</option>
								</select>
							</div>

							<div class="float-left">
								<button class="btn btn-default" v-on:click="window._securityControllerInstance.showSecrets()">
									Cancel
								</button>
							</div>

							<div class="float-right">
								<button class="btn btn-success" v-on:click="window._securityControllerInstance.saveSecret()">
									Save
								</button>
							</div>
						</div>
						<div class="card-body" v-if="!addingSecret">
							<div class="float-right">
								<button class="btn btn-sm btn-primary" v-on:click="window._securityControllerInstance.addSecret()">
									Add Secret
								</button>
							</div>

							<p>
								Secrets - such as connection strings or API keys - can be defined within the system here.
							</p>

							<p>
								These secrets will not be checked into version control, and can be resolved within any piece of configuration through using the
								<code class="inline">$.env</code> collection. Secrets can be scoped for global or system usage. When your application
								is deployed into a new environment you will need to configure the values for these secrets before your application becomes
								available.
							</p>

							<div class="table-responsive">
								<table class="table table-bordered" width="100%" cellspacing="0">
									<thead>
										<tr>
											<th>Name</th>
											<th>Scope</th>
											<th>Value</th>
											<th>Options</th>
										</tr>
									</thead>
									<tbody>
										<tr v-if="secrets.length === 0">
											<td colspan="4">
												<div class="noResults">
													No secrets have been defined.
												</div>
											</td>
										</tr>
										<tr v-for="secret in secrets">
											<td>
												{{secret.name}}
											</td>
											<td>
												{{secret.scope}}
											</td>
											<td width="60%">
												<span class="form-control form-control-sm form-control--disabled" v-if="!settingSecretValue || currentSecret.name !== secret.name">*********************</span>
												<input v-if="settingSecretValue && currentSecret.name === secret.name" v-model="currentSecret.value" class="form-control form-control-sm" />
											</td>
											<td width="15%">
												<span v-if="!settingSecretValue || currentSecret.name !== secret.name">
													<button class="btn btn-primary btn-sm" v-on:click="window._securityControllerInstance.setSecret(secret.name)">
														Set
													</button>
													<button class="btn btn-danger btn-sm" v-on:click="window._securityControllerInstance.removeSecret(secret.name)">
														Remove
													</button>
												</span>
												<span v-if="settingSecretValue && currentSecret.name === secret.name">
													<button class="btn btn-primary btn-sm" v-on:click="window._securityControllerInstance.saveSecretValue()">
														Save
													</button>
													<button class="btn btn-default btn-sm" v-on:click="window._securityControllerInstance.cancelSetSecret()">
														Cancel
													</button>
												</span>
											</td>
										</tr>
									</tbody>
									<tfoot>
										<tr>
											<th>Name</th>
											<th>Scope</th>
											<th>Value</th>
											<th>Options</th>
										</tr>
									</tfoot>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container-fluid" v-if="settingsVisible">
			<div class="row">
				<div class="col-md-6">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Scopes</h6>
						</div>
						<div class="card-body">
							<p>
								The following scopes have been configured on the Identity Provider.
							</p>

							<div class="float-right">
								<router-link class="btn btn-sm btn-primary" :to="{ name : 'securityScopeEditor', params : { name : '.new' }}">
									Add Scope
								</router-link>
							</div>

							<p>
								<b>Scopes</b>
							</p>

							<div class="table-responsive">
								<table class="table table-bordered" width="100%" cellspacing="0">
									<thead>
										<tr>
											<th>Name</th>
											<th>Options</th>
										</tr>
									</thead>
									<tfoot>
										<tr>
											<th>Name</th>
											<th>Options</th>
										</tr>
									</tfoot>
									<tbody>
										<tr v-if="scopes.length === 0">
											<td colspan="2">
												<div class="noResults">
													No scopes are currently configured.
												</div>
											</td>
										</tr>
										<tr v-for="scope in scopes">
											<td>{{scope.name}}</td>
											<td>
												<router-link class="btn btn-sm btn-success" :to="{ name : 'securityScopeEditor', params : { name : scope.name }}">
													Modify
												</router-link>
												<button class="btn btn-sm btn-danger" v-on:click="_securityControllerInstance.deleteScope(scope.name);">
													Remove
												</button>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Clients</h6>
						</div>
						<div class="card-body">
							<div class="float-right">
								<router-link class="btn btn-sm btn-primary" :to="{ name : 'securityClientEditor', params : { id : '.new' }}">
									Add Client
								</router-link>
							</div>

							<p>
								The following clients have been registered with the Identity Provider - this includes auto-generated clients for your applications.
							</p>

							<div class="table-responsive">
								<table class="table table-bordered" width="100%" cellspacing="0">
									<thead>
										<tr>
											<th>Client Id</th>
											<th>Options</th>
										</tr>
									</thead>
									<tfoot>
										<tr>
											<th>Client Id</th>
											<th>Options</th>
										</tr>
									</tfoot>
									<tbody>
										<tr v-if="clients.length === 0">
											<td colspan="2">
												<div class="noResults">
													There are no clients configured.
												</div>
											</td>
										</tr>
										<tr v-for="client in clients">
											<td>
												{{client.client_id}}
											</td>
											<td>
												<router-link class="btn btn-sm btn-success" :to="{ name : 'securityClientEditor', params : { id : client.client_id }}">
													Modify
												</router-link>
												<button class="btn btn-sm btn-danger" v-on:click="_securityControllerInstance.deleteClient(client.client_id);">
													Remove
												</button>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Users</h6>
						</div>
						<div class="card-body">
							<div class="float-right">
								<router-link class="btn btn-sm btn-primary" :to="{ name : 'securityUserEditor', params : { name : '.new' }}">
									Add User
								</router-link>
							</div>

							<p>
								These are all the users currently registered within the Identity Provider.
							</p>

							<div class="table-responsive">
								<table class="table table-bordered" width="100%" cellspacing="0">
									<thead>
										<tr>
											<th>Subject</th>
											<th>Username</th>
											<th>Registered date</th>
											<th>Roles</th>
											<th>Options</th>
										</tr>
									</thead>
									<tfoot>
										<tr>
											<th>Subject</th>
											<th>Username</th>
											<th>Registered date</th>
											<th>Roles</th>
											<th>Options</th>
										</tr>
									</tfoot>
									<tbody>
										<tr v-if="users.length === 0">
											<td colspan="4">
												<div class="noResults">
													No uses exist in the system, how are you seeing this?
												</div>
											</td>
										</tr>
										<tr v-for="user in users">
											<td>
												{{user.id}}
											</td>
											<td>
												{{user.data.username}}
											</td>
											<td>
												{{user.data.registered}}
											</td>
											<td>
												<span v-for="role in (user.data.claims && user.data.claims.roles ? user.data.claims.roles : []).concat(user.data.claims && user.data.claims.role ? user.data.claims.role : [])" class="btn btn-xs btn-primary ml-1">
													{{role}}
												</span>
											</td>
											<td>
												<router-link class="btn btn-sm btn-success" :to="{ name : 'securityUserEditor', params : { name : user.id } }">
													Modify
												</router-link>
												<button class="btn btn-sm btn-danger"  v-on:click="_securityControllerInstance.deleteUser(user.id);">
													Remove
												</button>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</template>

<template id="template-securityClientEditor">
	<div class="securityClientEditor">
		<permissions :roles="['security_writer','security_admin','system_writer','system_admin']"></permissions>

		<navigation title="Client Editor" :navitems="navitems"></navigation>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : sectionVisible !== 'details' }">
			<div class="row">
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Details</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Identifier:</label>
								<input type="text" class="form-control" name="id" v-model="client.client_id" />
							</div>
							<div class="form-group">
								<label>Secret:</label>
								<input type="text" class="form-control" name="secret" v-model="client.client_secret" />
							</div>
							<div class="form-group">
								<label>Send emails from:</label>
								<input type="email" class="form-control" name="email_from" v-model="client.features.email_from" />
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Grant types</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Client Credentials</label>
								<input type="checkbox" class="form-control" name="client_credentials" v-model="grantTypes.client_credentials">
							</div>

							<div class="form-group">
								<label>Authorization Code</label>
								<input type="checkbox" class="form-control" name="authorization_code" v-model="grantTypes.authorization_code">
							</div>

							<div class="form-group">
								<label>Refresh Token</label>
								<input type="checkbox" class="form-control" name="refresh_token" v-model="grantTypes.refresh_token">
							</div>

							<div class="form-group">
								<label>Password</label>
								<input type="checkbox" class="form-control" name="password" v-model="grantTypes.password">
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Scopes</h6>
						</div>
						<div class="card-body" v-if="addingScope">
							<div class="form-group">
								<label>Scope</label>
								<select v-model="newScope" class="form-control">
									<option v-for="scope in allScopes" :value="scope.name" v-if="client.scope.indexOf(scope.name) === -1">
										{{scope.name}}
									</option>
								</select>
							</div>

							<div class="float-right">
                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.saveScope()">
                                    Add
                                </button>
                            </div>

                            <div class="float-left">
                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddScope()">
                                    Cancel
                                </button>
                            </div>
						</div>
						<div class="card-body" v-if="!addingScope">
							<div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addScope()">
                                    Add Scope
                                </button>
                            </div>

                            <div class="table-responsive py-3">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.scope.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No scopes
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.scope.length > 0 && scope.length > 0" v-for="scope in client.scope.split(' ')">
                                            <td>
                                                {{scope}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removeScope(scope)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Name</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
						</div>
					</div>
				</div>
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Redirect URIs</h6>
						</div>
						<div class="card-body" v-if="addingRedirectUri">
							<div class="form-group">
								<label>URI</label>
								<input type="uri" class="form-control" name="new_uri" v-model="newRedirectUri">
							</div>

							<div class="float-right">
                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.saveRedirectUri()">
                                    Add
                                </button>
                            </div>

                            <div class="float-left">
                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddingRedirectUri()">
                                    Cancel
                                </button>
                            </div>
						</div>
						<div class="card-body" v-if="!addingRedirectUri">
							<div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addRedirectUri()">
                                    Add URI
                                </button>
                            </div>

                            <div class="table-responsive py-3">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>URI</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.redirect_uris.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No redirect URIs
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.redirect_uris.length > 0" v-for="uri in client.redirect_uris">
                                            <td>
                                                {{uri}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removeRedirectUri(uri)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>URI</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : sectionVisible !== 'claims' }">
			<div class="row">
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header">
							<div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addClientClaim()">
                                    Add Client Claim
                                </button>
                            </div>
							<h6 class="m-0 font-weight-bold text-primary">Client Claims</h6>
						</div>
						<div class="card-body">
							<div v-if="addingClientClaim">
								<div class="form-group">
									<label>Name</label>
									<input type="text" class="form-control" name="claim_name" v-model="newClaimName" />
								</div>

								<div class="form-group">
									<label>Value</label>
									<input type="text" class="form-control" name="claim_value" v-model="newClaimValue" />
								</div>

								<div class="float-right">
	                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.saveClientClaim()">
	                                    Add
	                                </button>
	                            </div>

	                            <div class="float-left">
	                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddClientClaim()">
	                                    Cancel
	                                </button>
	                            </div>
							</div>

							<div class="table-responsive" v-if="!addingClientClaim">
								<table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="Object.keys(client.claims || {}).length === 0">
                                            <td colspan="3">
                                                <div class="noResults">
                                                    No claims
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-for="claim in _securityClientEditorControllerInstance.clientClaims()">
                                            <td>
                                                {{claim.name}}
                                            </td>
                                            <td>
                                            	{{claim.value}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="_securityClientEditorControllerInstance.removeClientClaim(claim.name, claim.value);">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                        	<th>Name</th>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : sectionVisible !== 'registration' }">
			<div class="row">
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Registration</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Enabled</label>
								<input type="checkbox" class="form-control" name="registration_enabled" v-model="client.features.registration.enabled" />
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Password Reset</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Enabled</label>
								<input type="checkbox" class="form-control" name="reset_enabled" v-model="client.features.reset.enabled" />
							</div>
							<div class="form-group">
								<label>Mechanism</label>
								<select class="form-control" name="reset_mechanism" v-model="client.features.reset.mechanism">
									<option value="link-token">Link token</option>
									<option value="totp">TOTP</option>
								</select>
							</div>
                            <div class="form-group">
                                <label>Notify User</label>
                                <input type="checkbox" class="form-control" name="reset_nofity" v-model="client.features.reset.notify" />
                            </div>
						</div>
					</div>
				</div>
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">TOTP</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Window time (seconds)</label>
								<input type="number" min="5" class="form-control" name="totp_time" v-model="client.features.totp.time" />
							</div>
							<div class="form-group">
								<label>Validity period (windows)</label>
								<input type="number" min="20" class="form-control" name="totp_window" v-model="client.features.totp.window" />
							</div>
						</div>
					</div>
				</div>
                <div class="col-md-6 pb-3">
                    <div class="card shadow">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Login</h6>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label>Notify User</label>
                                <input type="checkbox" class="form-control" name="reset_nofity" v-model="client.features.login.notify" />
                            </div>
                        </div>
                    </div>
                </div>
			</div>
		</div>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : sectionVisible !== 'passwords' }">
			<div class="row">
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header">
							<div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addBannedPassword()">
                                    Add Banned Password
                                </button>
                            </div>
							<h6 class="m-0 font-weight-bold text-primary">Banned Passwords</h6>
						</div>
						<div class="card-body">
							<div v-if="addingBannedPassword">
								<div class="form-group">
									<label>Name</label>
									<input type="text" class="form-control" name="terms_consent" v-model="newBannedPassword" />
								</div>

								<div class="float-right">
	                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.saveBannedPassword()">
	                                    Add
	                                </button>
	                            </div>

	                            <div class="float-left">
	                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddBannedPassword()">
	                                    Cancel
	                                </button>
	                            </div>
							</div>

							<div class="table-responsive" v-if="!addingBannedPassword">
								<table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Password</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.features.banned_passwords.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No banned passwords
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.features.banned_passwords.length > 0" v-for="password in client.features.banned_passwords">
                                            <td>
                                                {{password}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removeBannedPassword(password)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Password</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6 pb-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Password Rules</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Minimum length</label>
								<input type="number" min="6" class="form-control" name="password_min" v-model="client.features.password.min_length" />
							</div>
							<div class="form-group">
								<label>Maximum length</label>
								<input type="number" max="999" class="form-control" name="password_max" v-model="client.features.password.max_length" />
							</div>
							<div class="form-group">
								<label>Error message</label>
								<input type="text" class="form-control" name="password_error" v-model="client.features.password.error" />
							</div>
							<div class="form-group">
								<label>Minimum alpha characters</label>
								<input type="number" min="0" class="form-control" name="password_min_alpha" v-model="client.features.password.rules.alpha" />
							</div>
							<div class="form-group">
								<label>Minimum numeric characters</label>
								<input type="number" min="0" class="form-control" name="password_min_numeric" v-model="client.features.password.rules.numeric" />
							</div>
							<div class="form-group">
								<label>Minimum symbol characters</label>
								<input type="number" min="0" class="form-control" name="password_min_symbol" v-model="client.features.password.rules.symbols" />
							</div>
							<div class="form-group">
								<label>Require mixed case</label>
								<input type="checkbox" class="form-control" name="password_mixed_case" v-model="client.features.password.rules.mixed_case" />
							</div>
							<div class="form-group">
								<label>Validation regex</label>
								<input type="text" class="form-control" name="password_validation_regex" v-model="client.features.password.validation_regex" />
							</div>
						</div>
					</div>
				</div>
                <div class="col-md-6 pb-3">
                    <div class="card shadow">
                        <div class="card-header">
                            <div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.modifyPasswordHelper(-1)">
                                    Add Password Helper
                                </button>
                            </div>
                            <h6 class="m-0 font-weight-bold text-primary">Password Helpers</h6>
                        </div>
                        <div class="card-body">
                            <div v-if="addingPasswordHelper">
                                <div class="form-group">
                                    <label>Description</label>
                                    <input type="text" class="form-control" name="terms_consent" v-model="helperDescription" />
                                </div>

                                <div class="form-group">
                                    <label>Regex</label>
                                    <input type="text" class="form-control" name="terms_consent" v-model="helperRegex" />
                                </div>

                                <div class="float-right">
                                    <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.savePasswordHelper(helperIndex)">
                                        <span v-if="helperIndex === -1">Add</span>
                                        <span v-if="helperIndex > -1">Update</span>
                                    </button>
                                </div>

                                <div class="float-left">
                                    <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddPasswordHelper()">
                                        Cancel
                                    </button>
                                </div>
                            </div>

                            <div class="table-responsive" v-if="!addingPasswordHelper">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Description</th>
                                            <th>Regex</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.features.password.helpers.length === 0">
                                            <td colspan="3">
                                                <div class="noResults">
                                                    No password helpers
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.features.password.helpers.length > 0" v-for="(helper, index) in client.features.password.helpers">
                                            <td>
                                                {{helper.description}}
                                            </td>
                                            <td>
                                                {{helper.regex}}
                                            </td>
                                            <td>
                                                <button class="btn btn-primary btn-sm" v-on:click="window._securityClientEditorControllerInstance.modifyPasswordHelper(index)">
                                                    Modify
                                                </button>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removePasswordHelper(index)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Description</th>
                                            <th>Regex</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
			</div>
		</div>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : sectionVisible !== 'terms' }">
			<div class="row">
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Terms and Conditions</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Required</label>
								<input type="checkbox" class="form-control" name="terms_required" v-model="client.features.terms.required" />
							</div>
							<div class="form-group">
								<label>URL</label>
								<input type="uri" class="form-control" name="terms_url" v-model="client.features.terms.document" />
							</div>
							<div class="form-group">
								<label>Version</label>
								<input type="text" class="form-control" name="terms_version" v-model="client.features.terms.version" />
							</div>
							<div class="form-group">
								<label>Issue to</label>
								<input type="text" class="form-control" name="terms_claim" v-model="client.features.terms.issue_to" />
							</div>
							<div v-if="addingTermsImplicitConsent">
								<div class="form-group">
									<label>Name</label>
									<input type="text" class="form-control" name="terms_consent" v-model="newTermsImplicitConsent" />
								</div>

								<div class="float-right">
	                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.saveTermsImplicitConsent()">
	                                    Add
	                                </button>
	                            </div>

	                            <div class="float-left">
	                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddTermsImplicitConsent()">
	                                    Cancel
	                                </button>
	                            </div>
                            </div>
							<div class="table-responsive" v-if="!addingTermsImplicitConsent">
								<div class="float-right">
	                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addTermsImplicitConsent()">
	                                    Add Implicit Consent
	                                </button>
	                            </div>

								<label>Implicit consents</label>
								<table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.features.terms.implicit_consents.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No implicit consents
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.features.terms.implicit_consents.length > 0" v-for="consent in client.features.terms.implicit_consents">
                                            <td>
                                                {{consent}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removeTermsImplicitConsent(consent)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6 py-3">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Privacy Policy</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Required</label>
								<input type="checkbox" class="form-control" name="terms_required" v-model="client.features.privacy.required" />
							</div>
							<div class="form-group">
								<label>URL</label>
								<input type="uri" class="form-control" name="terms_url" v-model="client.features.privacy.document" />
							</div>
							<div class="form-group">
								<label>Version</label>
								<input type="text" class="form-control" name="terms_version" v-model="client.features.privacy.version" />
							</div>
							<div class="form-group">
								<label>Issue to</label>
								<input type="text" class="form-control" name="terms_claim" v-model="client.features.privacy.issue_to" />
							</div>
							<div v-if="addingPrivacyImplicitConsent">
								<div class="form-group">
									<label>Name</label>
									<input type="text" class="form-control" name="terms_consent" v-model="newPrivacyImplicitConsent" />
								</div>

								<div class="float-right">
	                                <button class="btn btn-success" v-on:click="window._securityClientEditorControllerInstance.savePrivacyImplicitConsent()">
	                                    Add
	                                </button>
	                            </div>

	                            <div class="float-left">
	                                <button class="btn btn-danger" v-on:click="window._securityClientEditorControllerInstance.cancelAddPrivacyImplicitConsent()">
	                                    Cancel
	                                </button>
	                            </div>
                            </div>
							<div class="table-responsive" v-if="!addingPrivacyImplicitConsent">
								<div class="float-right">
	                                <button class="btn btn-sm btn-primary" v-on:click="window._securityClientEditorControllerInstance.addPrivacyImplicitConsent()">
	                                    Add Implicit Consent
	                                </button>
	                            </div>

								<label>Implicit consents</label>
								<table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="client.features.privacy.implicit_consents.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No implicit consents
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-if="client.features.privacy.implicit_consents.length > 0" v-for="consent in client.features.privacy.implicit_consents">
                                            <td>
                                                {{consent}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityClientEditorControllerInstance.removePrivacyImplicitConsent(consent)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div v-bind:class="{ 'entityWrapper' : true, 'hidden' : sectionVisible !== 'editor' }">
			<div id="clientEditor" class="editorWindow"></div>
		</div>

		<div class="actionButtons">
			<router-link to="/security" class="rounded-circle border-0 btn btn-default"><i class="fas fa-fw fa-times"></i></router-link>
			<button class="rounded-circle border-0 btn btn-primary" v-on:click="_securityClientEditorControllerInstance.save();"><i class="fas fa-fw fa-save"></i></button>
		</div>
		<modal-error v-bind:title="error.title" v-bind:visible="error.visible">
			{{error.description}}
		</modal-error>
		<alert text="Client saved!" v-bind:visible="showAlert"></alert>
	</div>
</template>

<template id="template-securityScopeEditor">
	<div class="securityClientEditor">
		<permissions :roles="['security_writer','security_admin','system_writer','system_admin']"></permissions>

		<navigation title="Scope Editor" :navitems="navitems"></navigation>

		<div v-bind:class="{ 'entityWrapper' : true, 'hidden' : !editorVisible }">
			<div id="scopeEditor" class="editorWindow"></div>
		</div>
		
		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : !formVisible }">
			<div class="row">
				<div class="col-md-12">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Details</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Name:</label>
								<input type="text" class="form-control" name="name" v-model="scope.name" />
							</div>
						</div>
					</div>
				</div>
			</div>
            <div class="row">
                <div class="col-md-12">
                    <div class="card shadow">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Claims</h6>
                        </div>
                        <div class="card-body" v-if="addingClaim">
                            <p>
                                Enter the claim below.
                            </p>

                            <div class="form-group">
                                <label>Claim:</label>
                                <input type="text" class="form-control" name="name" v-model="currentClaim" />
                            </div>

                            <div class="float-left">
                                <button class="btn btn-default" v-on:click="window._securityScopeEditorControllerInstance.cancelAddClaim()">
                                    Cancel
                                </button>
                            </div>

                            <div class="float-right">
                                <button class="btn btn-success" v-on:click="window._securityScopeEditorControllerInstance.saveClaim()">
                                    Save
                                </button>
                            </div>
                        </div>
                        <div class="card-body" v-if="!addingClaim">
                            <div class="float-right">
                                <button class="btn btn-sm btn-primary" v-on:click="window._securityScopeEditorControllerInstance.addClaim()">
                                    Add Claim
                                </button>
                            </div>

                            <p>
                                These claims will be issued when a client requests this scope.
                            </p>

                            <div class="table-responsive">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="scope.claims.length === 0">
                                            <td colspan="2">
                                                <div class="noResults">
                                                    No claims
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-for="claim in scope.claims">
                                            <td>
                                                {{claim}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="window._securityScopeEditorControllerInstance.removeClaim(claim)">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>        
		</div>
		<div class="actionButtons">
			<router-link to="/security" class="rounded-circle border-0 btn btn-default"><i class="fas fa-fw fa-times"></i></router-link>
			<button class="rounded-circle border-0 btn btn-primary" v-on:click="_securityScopeEditorControllerInstance.save();"><i class="fas fa-fw fa-save"></i></button>
		</div>
		<modal-error v-bind:title="error.title" v-bind:visible="error.visible">
			{{error.description}}
		</modal-error>
		<alert text="Scope saved!" v-bind:visible="showAlert"></alert>
	</div>
</template>

<template id="template-securityUserEditor">
	<div class="securityClientEditor">
		<permissions :roles="['security_writer','security_admin','system_writer','system_admin']"></permissions>

		<navigation title="User Editor" :navitems="navitems"></navigation>

		<div v-bind:class="{ 'container-fluid' : true, 'hidden' : !formVisible }">
			<div class="row">
				<div class="col-md-6">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Authentication</h6>
						</div>
						<div class="card-body">							
							<div class="form-group">
								<label>Username:</label>
								<input type="text" class="form-control" name="username" v-model="user.username" />
							</div>
							<div class="form-group">								
								<label>Password:</label>
								<div class="row">
									<div class="col-md-9">
										<input type="password" :disabled="!enteringPassword" class="form-control" name="password" v-model="user.password"/>								
									</div>
									<div class="col-md-3">
	                                	<button :disabled="enteringPassword" class="btn btn-warning float-right" v-on:click="window._securityUserEditorControllerInstance.clearPassword()">
	                                    	Reset Password
	                                	</button>
	                            	</div>
								</div>								
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="card shadow">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Details</h6>
						</div>
						<div class="card-body">
							<div class="form-group">
								<label>Subject:</label>
								<input type="text" disabled class="form-control" name="subject" v-model="user.subject" />
							</div>
							<div class="form-group">
								<label>Registered on:</label>
								<input type="text" disabled class="form-control" name="registered" v-model="user.registered" />
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-12">
					<div class="card shadow my-3">
						<div class="card-header py-3">
							<h6 class="m-0 font-weight-bold text-primary">Claims</h6>
						</div>
						<div class="card-body" v-if="addingClaim">
                            <p>
                                Enter the claim below.
                            </p>

                            <div class="form-group">
                                <label>Name:</label>
                                <input type="text" class="form-control" name="name" v-model="currentClaim.name" />
                            </div>

                            <div class="form-group">
                                <label>Value:</label>
                                <input type="text" class="form-control" name="name" v-model="currentClaim.value" />
                            </div>

                            <div class="float-left">
                                <button class="btn btn-default" v-on:click="window._securityUserEditorControllerInstance.cancelAddClaim()">
                                    Cancel
                                </button>
                            </div>

                            <div class="float-right">
                                <button class="btn btn-success" v-on:click="window._securityUserEditorControllerInstance.saveClaim()">
                                    Add
                                </button>
                            </div>
                        </div>
                        <div class="card-body" v-if="!addingClaim">
							<div class="float-right pb-3">
                                <button class="btn btn-sm btn-primary" v-on:click="_securityUserEditorControllerInstance.addClaim();">
                                    Add Claim
                                </button>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-bordered" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-if="Object.keys(user.claims || {}).length === 0">
                                            <td colspan="3">
                                                <div class="noResults">
                                                    No claims
                                                </div>
                                            </td>
                                        </tr>
                                        <tr v-for="claim in _securityUserEditorControllerInstance.userClaims()">
                                            <td>
                                                {{claim.name}}
                                            </td>
                                            <td>
                                            	{{claim.value}}
                                            </td>
                                            <td>
                                                <button class="btn btn-danger btn-sm" v-on:click="_securityUserEditorControllerInstance.removeClaim(claim.name, claim.value);">
                                                    Remove
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                        	<th>Name</th>
                                            <th>Value</th>
                                            <th>Options</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div v-bind:class="{ 'entityWrapper' : true, 'hidden' : formVisible }">
			<div id="userEditor" class="editorWindow"></div>
		</div>
		<div class="actionButtons">
			<router-link to="/security" class="rounded-circle border-0 btn btn-default"><i class="fas fa-fw fa-times"></i></router-link>
			<button class="rounded-circle border-0 btn btn-primary" v-on:click="_securityUserEditorControllerInstance.save();"><i class="fas fa-fw fa-save"></i></button>
		</div>
		<modal-error v-bind:title="error.title" v-bind:visible="error.visible" v-bind:onclose="_securityUserEditorControllerInstance.closeError">
			<div v-html="error.description"></div>
		</modal-error>
		<alert text="User saved!" v-bind:visible="showAlert"></alert>
	</div>
</template>